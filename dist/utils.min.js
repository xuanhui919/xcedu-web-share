"use strict";function e(o){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(o)}Object.defineProperty(exports,"__esModule",{value:!0});var o,t=function(e){return Object.keys(e).reduce((function(e,o){return e.push("".concat(o,"=").concat(query[o])),e}),[]).join("&")};Vue.mixin({beforeMount:function(){var e=this.$options.asyncData;e&&e({store:this.$store,route:this.$route})},beforeRouteUpdate:function(e,o,t){var n=this.$options.asyncData;n&&n({store:this.$store,route:e}),t()}}),Vue.mixin({methods:{navigateToUrl:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t(o),r=n?"".concat(e,"?").concat(n):e;if(window.singleSpaNavigate)window.singleSpa.navigateToUrl(r);else{var s=location.protocol,i=location.host;location.href="".concat(s,"//").concat(i).concat(r)}}}});try{o=localStorage}catch(e){console.log("localStorage not available, fallback to sessionStorage"),o=sessionStorage}window.webStorage=o;var n=o,r=function(e){return n.getItem(e)||""},s=function(e,o){return n.setItem(e,o)},i=function(){var e=r("token");return e?"Bearer "+e:""},a=function(e){return s("token",e)},u=function(){return r("refreshToken")},c=function(e){return s("refreshToken",e)},f=function(){n.removeItem("token"),n.removeItem("refreshToken")},p=Object.freeze({__proto__:null,getToken:i,setToken:a,getRefreshToken:u,setRefreshToken:c,clearToken:f}),l=axios.create({baseURL:"/api/v1",headers:{"Content-Type":"application/json"},transformRequest:[function(e){return JSON.stringify(e)}],responseType:"json"});l.interceptors.request.use((function(e){var o=i();return o&&(e.headers.Authorization=o),e}));l.interceptors.response.use((function(e){if(e.data)return e.data.data}),(function(e){return 401===(t=e.response).status&&403===t.request.response.code&&u()?(o=e.config,l.post("/sysUserLogin/refreshToken",{refreshToken:u()}).then((function(e){return a(e.access_token),c(e.refresh_token),l.request(o)}))):(401===e.response.status&&(f(),window.singleSpa.navigateToUrl("/user/login")),Promise.reject(e));var o,t})),Vue.use(ELEMENT),Vue.config.productionTip=!1,exports.axios=l,exports.boot=function(o,t,n){if(void 0===e(window.Vue))throw new ReferenceError("No Gobal Vue found!");var r,s,i;VuexRouterSync.sync(o,t);var a={router:t,store:o,render:function(e){return e(n)}};if(window.singleSpaNavigate&&window.singleSpaVue){var u=window.singleSpaVue({Vue:Vue,appOptions:a});r=u.bootstrap,s=u.mount,i=u.unmount}else new Vue(a).$mount("#app");return{bootstrap:r,mount:s,unmount:i}},exports.setPublicPath=function(e){window.singleSpaNavigate&&window.System&&window.SystemjsWebapckInterop.setPublicPath(e)},exports.token=p,exports.webStorage=l;
